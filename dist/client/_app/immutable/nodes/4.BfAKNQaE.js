import{s as ye,e as ge,f as Ee,h as he,r as Me,c as Z,o as Ie}from"../chunks/scheduler.DTn6sg0E.js";import{S as ke,i as Te,v as ve,e as p,s as y,w as G,k as Le,c as g,d as f,f as E,a as I,l as le,x as A,r as m,h as u,g as B,y as W,u as Ve,q as J,o as N,z as x,t as te,b as se,j as De}from"../chunks/index.BrvKFv8V.js";import{I as qe,a as Pe,b as je,g as Se}from"../chunks/index.Ck7fa_ST.js";import{B as _e,l as He}from"../chunks/loginSession.Bmowu5Lj.js";import{L as ze}from"../chunks/Link.CK2OdIu8.js";import{p as Be}from"../chunks/stores.BFoAtfGU.js";import{g as ee}from"../chunks/entry.xM4ousmE.js";const Ce=t=>{for(const s of t.elements)if(s instanceof HTMLInputElement&&!s.checkValidity()){s.focus();break}},{document:ue}=Se;function Oe(t){let s;return{c(){s=te("Google")},l(a){s=se(a,"Google")},m(a,r){B(a,s,r)},d(a){a&&f(s)}}}function Re(t){let s;return{c(){s=te("Recover Password")},l(a){s=se(a,"Recover Password")},m(a,r){B(a,s,r)},d(a){a&&f(s)}}}function we(t){let s,a;return{c(){s=p("p"),a=te(t[0]),this.h()},l(r){s=g(r,"P",{class:!0});var n=I(s);a=se(n,t[0]),n.forEach(f),this.h()},h(){m(s,"class","text-danger")},m(r,n){B(r,s,n),u(s,a)},p(r,n){n&1&&De(a,r[0])},d(r){r&&f(s)}}}function Fe(t){let s;return{c(){s=te("log in")},l(a){s=se(a,"log in")},m(a,r){B(a,s,r)},d(a){a&&f(s)}}}function Ge(t){let s,a,r,n,b,C='<h4 class="font-bold text-4xl mb-1 text-center">Welcome Back</h4> <p class="text-center font-normal text-xl">Welcome to our community</p>',k,M,_,P,d,K='<span class="uppercase text-sm px-3 bg-gray-100">or</span>',O,T,w,o,h,v,$,H,ae,Q,ne,L,j,fe='<input type="checkbox" name="remember" id="remember"/> <p>Remember me</p>',re,z,V,oe,U,D,X,ie,de;_=new _e({props:{type:"button",variant:"outline",title:"Google Login Auth",id:"googleButton",$$slots:{default:[Oe]},$$scope:{ctx:t}}});function $e(e){t[9](e)}let ce={type:"email",id:t[2].id,field:t[6],required:!0,pattern:"^[w-.]+@([w-]+.)+[w-]{2,4}$",placeholder:"Enter your email",invalidText:t[2].valueMissing?"Email is required":t[2].typeMismatch?"Email not available":t[2].patternMismatch?"Email error syntax":"",showMessage:!t[2].show};t[1].email!==void 0&&(ce.value=t[1].email),w=new qe({props:ce}),ge.push(()=>ve(w,"value",$e));function be(e){t[10](e)}let me={field:t[7],min:8,max:30,id:"password",required:!0,placeholder:"Enter your password",invalidText:t[3].valueMissing?"Password is required":t[3].tooShort?"Password must has 8 character":t[3].patternMismatch?"Must contain at least one uppercase, lowercase, and number":"",showMessage:!t[3].show};t[1].password!==void 0&&(me.value=t[1].password),$=new Pe({props:me}),ge.push(()=>ve($,"value",be)),V=new ze({props:{href:"/forget",underline:!0,typeText:!0,$$slots:{default:[Re]},$$scope:{ctx:t}}});let c=t[0]&&we(t);return D=new _e({props:{type:"submit",variant:"outline",title:"Login Button",size:"lg",disable:!t[4].valid,classStyled:" w-full uppercase border-2 border-gray-500 group-invalid:pointer-events-none group-invalid:opacity-30",$$slots:{default:[Fe]},$$scope:{ctx:t}}}),{c(){s=p("meta"),a=y(),r=p("div"),n=p("form"),b=p("div"),b.innerHTML=C,k=y(),M=p("div"),G(_.$$.fragment),P=y(),d=p("div"),d.innerHTML=K,O=y(),T=p("div"),G(w.$$.fragment),h=y(),v=p("div"),G($.$$.fragment),ae=y(),Q=p("div"),ne=y(),L=p("div"),j=p("div"),j.innerHTML=fe,re=y(),z=p("div"),G(V.$$.fragment),oe=y(),c&&c.c(),U=y(),G(D.$$.fragment),this.h()},l(e){const l=Le("svelte-18hoje6",ue.head);s=g(l,"META",{name:!0,content:!0}),l.forEach(f),a=E(e),r=g(e,"DIV",{class:!0});var R=I(r);n=g(R,"FORM",{id:!0,autocomplete:!0,class:!0});var i=I(n);b=g(i,"DIV",{class:!0,"data-svelte-h":!0}),le(b)!=="svelte-j6kexz"&&(b.innerHTML=C),k=E(i),M=g(i,"DIV",{class:!0});var S=I(M);A(_.$$.fragment,S),S.forEach(f),P=E(i),d=g(i,"DIV",{class:!0,"data-svelte-h":!0}),le(d)!=="svelte-19irww5"&&(d.innerHTML=K),O=E(i),T=g(i,"DIV",{class:!0});var F=I(T);A(w.$$.fragment,F),F.forEach(f),h=E(i),v=g(i,"DIV",{class:!0});var q=I(v);A($.$$.fragment,q),ae=E(q),Q=g(q,"DIV",{}),I(Q).forEach(f),q.forEach(f),ne=E(i),L=g(i,"DIV",{class:!0});var Y=I(L);j=g(Y,"DIV",{class:!0,"data-svelte-h":!0}),le(j)!=="svelte-yqp3zt"&&(j.innerHTML=fe),re=E(Y),z=g(Y,"DIV",{class:!0});var pe=I(z);A(V.$$.fragment,pe),pe.forEach(f),Y.forEach(f),oe=E(i),c&&c.l(i),U=E(i),A(D.$$.fragment,i),i.forEach(f),R.forEach(f),this.h()},h(){ue.title="Login Form",m(s,"name","robots"),m(s,"content","noindex, nofollow"),m(b,"class",""),m(M,"class","justify-self-center w-fit"),m(d,"class","relative z-10 text-center after:absolute after:top-3 after:left-0 after:w-full after:border after:border-gray-300 after:-z-10 w-full"),m(T,"class",""),m(v,"class",""),m(j,"class","flex gap-2 items-center"),m(z,"class",""),m(L,"class","w-full flex justify-between"),m(n,"id","signIn"),m(n,"autocomplete","on"),n.noValidate=!0,m(n,"class","mt-3 grid gap-5 w-[28rem] py-4"),m(r,"class","flex justify-center my-3 max-w-full")},m(e,l){u(ue.head,s),B(e,a,l),B(e,r,l),u(r,n),u(n,b),u(n,k),u(n,M),W(_,M,null),u(n,P),u(n,d),u(n,O),u(n,T),W(w,T,null),u(n,h),u(n,v),W($,v,null),u(v,ae),u(v,Q),u(n,ne),u(n,L),u(L,j),u(L,re),u(L,z),W(V,z,null),u(n,oe),c&&c.m(n,null),u(n,U),W(D,n,null),X=!0,ie||(de=[Ee(t[5].call(null,n)),Ve(n,"submit",t[8])],ie=!0)},p(e,[l]){const R={};l&8192&&(R.$$scope={dirty:l,ctx:e}),_.$set(R);const i={};l&4&&(i.id=e[2].id),l&4&&(i.invalidText=e[2].valueMissing?"Email is required":e[2].typeMismatch?"Email not available":e[2].patternMismatch?"Email error syntax":""),l&4&&(i.showMessage=!e[2].show),!o&&l&2&&(o=!0,i.value=e[1].email,he(()=>o=!1)),w.$set(i);const S={};l&8&&(S.invalidText=e[3].valueMissing?"Password is required":e[3].tooShort?"Password must has 8 character":e[3].patternMismatch?"Must contain at least one uppercase, lowercase, and number":""),l&8&&(S.showMessage=!e[3].show),!H&&l&2&&(H=!0,S.value=e[1].password,he(()=>H=!1)),$.$set(S);const F={};l&8192&&(F.$$scope={dirty:l,ctx:e}),V.$set(F),e[0]?c?c.p(e,l):(c=we(e),c.c(),c.m(n,U)):c&&(c.d(1),c=null);const q={};l&16&&(q.disable=!e[4].valid),l&8192&&(q.$$scope={dirty:l,ctx:e}),D.$set(q)},i(e){X||(J(_.$$.fragment,e),J(w.$$.fragment,e),J($.$$.fragment,e),J(V.$$.fragment,e),J(D.$$.fragment,e),X=!0)},o(e){N(_.$$.fragment,e),N(w.$$.fragment,e),N($.$$.fragment,e),N(V.$$.fragment,e),N(D.$$.fragment,e),X=!1},d(e){e&&(f(a),f(r)),f(s),x(_),x(w),x($),x(V),c&&c.d(),x(D),ie=!1,Me(de)}}}function Ae(t,s,a){let r,n,b,C;Z(t,Be,o=>a(11,r=o));const k=je();Z(t,k,o=>a(4,C=o));const M=k.field({onDirty:!0});Z(t,M,o=>a(2,n=o));const _=k.field({onDirty:!0});Z(t,_,o=>a(3,b=o));let P;const d={email:"",password:""};async function K(){a(0,P="");const o=document.getElementById("signIn");if(o.checkValidity())try{await O(d)}catch(h){h instanceof Error&&a(0,P=h.message)}else{o.classList.add("was-validated"),Ce(o);return}}Ie(()=>{});async function O(o){try{const h=await fetch("auth/login",{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json"}}),v=await h.json();if(h.ok){He.set(v.user);const{role:$}=v.user,H=r.url.searchParams.get("referrer");switch(H&&ee(H),$){case"admin":ee("/admin");break;case"manager":ee("/manager");break;default:ee("/")}}else throw new Error(v.message)}catch(h){h instanceof Error&&console.error("Login error",h)}}function T(o){t.$$.not_equal(d.email,o)&&(d.email=o,a(1,d))}function w(o){t.$$.not_equal(d.password,o)&&(d.password=o,a(1,d))}return[P,d,n,b,C,k,M,_,K,T,w]}class Xe extends ke{constructor(s){super(),Te(this,s,Ae,Ge,ye,{})}}export{Xe as component};
